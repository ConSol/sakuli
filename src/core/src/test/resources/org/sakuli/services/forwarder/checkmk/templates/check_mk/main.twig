{% spaceless %}
    {{ testsuite.state.nagiosErrorCode }} sakuli_{{ testsuite.state.errorCode }}_{{ testsuite.state.name }} suite__state={{ testsuite.state.errorCode }};;;;
    |suite__warning={{ testsuite.warningTime }}s;;;;|suite__critical={{ testsuite.criticalTime }}s;;;;|suite_{{ testsuite.id }}={{ testsuite.duration }}s;{{ testsuite.warningTime }};{{ testsuite.criticalTime }};;
        {% for testCaseId, testCase in testsuite.testCasesAsSortedSet %}
            {% set testCaseIndex = format("%03d", loop.index) %}
            |c_{{ testCaseIndex }}__state={{ testCase.state.errorCode }};;;;
            |c_{{ testCaseIndex }}__warning={{ testCase.warningTime }}s;;;;
            |c_{{ testCaseIndex }}__critical={{ testCase.criticalTime }}s;;;;
            |c_{{ testCaseIndex }}_{{ testCase.id }}={{ testCase.duration }}s;{{ testCase.warningTime }};{{ testCase.criticalTime }};;
            {% for testStep in testCase.steps %}
            {% set testStepIndex = format("%03d", loop.index) %}
                |s_{{ testCaseIndex }}_{{ testStepIndex }}_{{testStep.name}}={{testStep.duration}}s;{{testStep.warningTime}};;;
            {% endfor %}
        {% endfor %}
    $whitespace$Sakuli suite "{{testsuite.id}}"$whitespace$
        {% if (testsuite.state.error) %}
            {% set exceptionMessages = getExceptionMessages(testsuite, true) %}
            ({{testsuite.duration}}s) {{testsuite.state.nagiosStateDescription}}: {{abbreviate(exceptionMessages, 200)}}
        {% else %}
            {{testsuite.state.nagiosStateDescription}}
            {% if (testsuite.state.ok) %}
                $whitespace$({{testsuite.duration}}s).
            {% elseif (testsuite.state.name == 'WARNING_IN_SUITE') %}
                $whitespace$({{testsuite.duration}}s/warn at {{ testsuite.warningTime }}s).
            {% elseif (testsuite.state.name == 'CRITICAL_IN_SUITE') %}
                $whitespace$({{testsuite.duration}}s/crit at {{ testsuite.criticalTime }}s).
            {% elseif (testsuite.state.name == 'WARNING_IN_STEP') %}
                {% for testCaseId, testCase in testsuite.testCasesAsSortedSet %}
                    {% if (testCase.state.warningInStep) %}
                        {% for testStep in testCase.steps %}
                            {% if (testStep.state.warning) %}
                                , step "{{testStep.id}}" over runtime ({{testStep.duration}}s/warn at {{ testStep.warningTime }}s).
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            {% elseif (testsuite.state.name == 'WARNING_IN_CASE') %}
                {% for testCaseId, testCase in testsuite.testCasesAsSortedSet %}
                    {% if (testCase.state.warning) %}
                        , case "{{testCase.id}}" over runtime ({{testCase.duration}}s/warn at {{ testCase.warningTime }}s).
                    {% endif %}
                {% endfor %}
            {% elseif (testsuite.state.name == 'CRITICAL_IN_CASE') %}
                {% for testCaseId, testCase in testsuite.testCasesAsSortedSet %}
                    {% if (testCase.state.critical) %}
                        , case "{{testCase.id}}" over runtime ({{testCase.duration}}s/crit at {{ testCase.criticalTime }}s).
                    {% endif %}
                {% endfor %}
            {% endif %}
            $whitespace$(Last suite run: {% if (empty(testsuite.stopDate)) %}xx{% else %}{{ testsuite.stopDate|date("dd.MM.YY HH:mm:ss") }}{% endif %})
        {% endif %}
    {% if (testsuite.state.error) %}
        $whitespace${% include 'summary_styles.twig' %}
        {% include 'summary.twig' %}
    {% endif %}
{% endspaceless %}